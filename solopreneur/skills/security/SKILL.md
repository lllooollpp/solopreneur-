---
name: security
description: "应用安全审查与加固。用于威胁建模、漏洞识别、依赖安全检查、配置加固与修复验证。"
metadata: {"solopreneur":{"emoji":"🛡️","always":false}}
---

# 应用安全技能

## 最小安全审查清单（MVP）

1. 认证与授权
- 是否存在未鉴权接口
- 是否存在水平/垂直越权
- 管理员能力是否被普通用户调用

2. 输入与输出
- 所有外部输入是否有校验（长度、类型、格式）
- SQL/命令/模板拼接是否参数化
- 前端输出是否做 XSS 防护

3. 敏感信息
- 密钥、Token、密码是否硬编码
- 日志中是否打印敏感信息
- 传输和存储是否遵循最小暴露原则

4. 依赖与配置
- 关键依赖是否存在高危漏洞
- 调试开关是否在生产环境关闭
- CORS / CSP / 安全响应头是否合理

## 风险分级模板

- **严重 (Critical)**: 可直接导致数据泄露/远程执行/权限接管
- **高 (High)**: 可稳定利用，影响核心业务安全
- **中 (Medium)**: 需特定条件，影响可控
- **低 (Low)**: 最佳实践偏差，短期可接受

## 修复建议格式

```markdown
### [风险标题]
- 级别: 高
- 影响范围: auth/api.py
- 利用条件: 已登录普通用户
- 修复动作:
  1. ...
  2. ...
- 验证方式:
  - 用例1: ...
  - 用例2: ...
```
