{
  "_comment": "Nanobot 配置示例文件 - Token 控制相关配置",
  "_usage": "复制此文件到 ~/.nanobot/config.json 并根据需要修改",

  "agents": {
    "defaults": {
      "workspace": "~/.nanobot/workspace",

      "_comment_max_tokens": "单次 LLM 调用的最大输出 Token 数",
      "_comment_max_tokens_note": "越小越节省，但响应可能被截断",
      "max_tokens": 8192,

      "_comment_temperature": "温度参数，影响输出多样性",
      "_comment_temperature_note": "0.0-0.3 精确但短，0.7-1.0 有创意但长",
      "temperature": 0.7,

      "_comment_review_mode": "审批模式：auto=自动审核继续执行，manual=人工审核（先通知用户确认）",
      "review_mode": "auto",

      "_comment_max_tool_iterations": "最大工具调用迭代次数",
      "_comment_max_tool_iterations_note": "间接控制 Token 消耗，每次迭代可能调用多个工具",
      "max_tool_iterations": 20,

      "_comment_max_subagents": "最大并发子 Agent 数",
      "_comment_max_subagents_note": "限制并行任务数量，控制整体 Token 消耗",
      "max_subagents": 5,

      "_comment_session_cache_size": "Session LRU 缓存大小",
      "_comment_session_cache_size_note": "超过此数量会自动删除最旧的会话",
      "session_cache_size": 100,

      "_comment_agent_timeout": "Agent 执行总超时（秒）",
      "_comment_agent_timeout_note": "防止无限循环或耗时过长",
      "agent_timeout": 1800,

      "_comment_max_tokens_per_session": "每个会话最大 Token 消耗",
      "_comment_max_tokens_per_session_note": "超限后自动压缩上下文继续执行",
      "max_tokens_per_session": 500000
    }
  },

  "providers": {
    "_comment": "LLM 提供者配置",
    "_comment_note": "不同模型的 Token 价格差异很大",
    "_comment_priority": "选择哪个 Provider 由 nanobot.core.dependencies.get_llm_provider() 决定，优先使用 Copilot",
    "anthropic": {
      "api_key": "your-api-key",
      "api_base": null,
      "_comment_model_recommendation": "claude-3-haiku 最便宜，claude-3-5-sonnet 最平衡",
      "_comment_example": "claude-3-haiku: ~$0.25/1M tokens, claude-3-5-sonnet: ~$3/1M tokens"
    },
    "openai": {
      "api_key": "your-api-key",
      "api_base": null,
      "_comment_model_recommendation": "gpt-4o-mini 最便宜，gpt-4o 最平衡"
    },
    "vllm": {
      "_comment": "本地 OpenAI 标准接口 (vLLM, Ollama, text-generation-webui 等)",
      "api_key": "dummy",
      "api_base": "http://localhost:8000/v1",
      "_comment_models": "常见本地模型: llama-3-8b, llama-3-70b, qwen-7b, yi-34b"
    },
    "zhipu": {
      "_comment": "火山引擎 / 智谱 AI",
      "api_key": "your-zhipu-api-key",
      "api_base": "https://open.bigmodel.cn/api/paas/v4/",
      "_comment_models": "glm-4, glm-4-plus, glm-3-turbo, glm-4-flash"
    },
    "openrouter": {
      "_comment": "OpenRouter 统一访问多个 LLM",
      "api_key": "sk-or-...",
      "api_base": "https://openrouter.ai/api/v1"
    },
    "groq": {
      "_comment": "Groq 超快推理",
      "api_key": "your-groq-api-key",
      "api_base": null
    },
    "gemini": {
      "_comment": "Google Gemini",
      "api_key": "your-gemini-api-key",
      "api_base": null
    }
  },

  "channels": {
    "wecom": {
      "enabled": true,
      "corp_id": "",
      "agent_id": "1000002",
      "secret": "UXC9jCRikya_NdF2pixpk-IFvZOxeN84nWVaFFJeYCk",
      "token": "",
      "aes_key": ""
    },
    "telegram": {
      "enabled": false,
      "token": "",
      "allow_from": []
    },
    "whatsapp": {
      "enabled": false,
      "bridge_url": "ws://localhost:3001",
      "allow_from": []
    }
  },

  "tools": {
    "web": {
      "search": {
        "api_key": "",
        "max_results": 5,
        "timeout": 10,
        "max_query_length": 500
      }
    },
    "exec": {
      "_comment": "Shell 执行工具配置",
      "timeout": 60,
      "restrict_to_workspace": false,
      "whitelist_mode": false,
      "max_output_size": 10000
    }
  },

  "tokenPool": {
    "_comment": "账号池全局配置（可通过环境变量覆盖）",
    "_comment_env": "支持的环境变量: NANOBOT_TOKEN_POOL__MAX_TOKENS_PER_DAY",
    "maxTokensPerDay": 0,
    "_comment_maxTokensPerDay": "每个账号每日最大Token限制（0=无限制）",

    "maxRequestsPerDay": 0,
    "_comment_maxRequestsPerDay": "每个账号每日最大请求次数（0=无限制）",

    "maxRequestsPerHour": 0,
    "_comment_maxRequestsPerHour": "每个账号每小时最大请求次数（0=无限制）",

    "baseCooldownSeconds": 30,
    "_comment_baseCooldownSeconds": "429错误后基础冷却时间（秒）",

    "maxCooldownSeconds": 300,
    "_comment_maxCooldownSeconds": "最大冷却时间（秒）",

    "deadThreshold": 10,
    "_comment_deadThreshold": "连续错误多少次标记为DEAD"
  },

  "_presets": {
    "_comment": "不同场景的 Token 控制预设",
    "minimal": {
      "description": "极致节省 Token 模式",
      "agents": {
        "defaults": {
          "model": "claude-3-haiku",
          "max_tokens": 1024,
          "max_tokens_per_session": 50000,
          "max_tool_iterations": 5,
          "max_subagents": 2,
          "temperature": 0.2
        }
      }
    },
    "balanced": {
      "description": "平衡模式（推荐默认）",
      "agents": {
        "defaults": {
          "model": "gpt-4o-mini",
          "max_tokens": 4096,
          "max_tokens_per_session": 200000,
          "max_tool_iterations": 15,
          "max_subagents": 3,
          "temperature": 0.5
        }
      }
    },
    "powerful": {
      "description": "高性能模式（不关心成本）",
      "agents": {
        "defaults": {
          "model": "claude-3-5-sonnet",
          "max_tokens": 8192,
          "max_tokens_per_session": 1000000,
          "max_tool_iterations": 30,
          "max_subagents": 5,
          "temperature": 0.7
        }
      }
    }
  }
}
