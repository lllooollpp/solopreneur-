# 功能规范：前端管理界面、Copilot 模型与企业微信集成

**分支**：001-frontend-copilot-wecom  
**创建时间**：2026-02-05  
**状态**：草稿  
**输入描述**：1 添加前端项目文件夹， 使用vue3 + ts ，界面内容要涵盖 配置、chatbot 、dashboard 、flow等功能的支持 ； 2 添加github copilot 模型的支持 ； 3 不需要其他渠道了 ，添加企业微信的渠道支持 ；

## 用户场景与测试（必填）

### 用户故事1 - 通过 Web 界面管理 solopreneur（优先级：P1）
作为一个用户，我希望通过一个美观的 Web 前端来配置我的 Agent，查看运行状态并与之聊天，而不是仅依赖命令行。
**优先级说明**：前端界面是提升用户体验的核心，涵盖了配置和交互的关键功能。
**独立测试**：启动前端开发服务器，确保可以访问各个导航页（配置、对话等）。
**验收场景**：
1. **假设**前端项目已启动，**当**用户访问 Dashboard 时，**则**页面应显示当前的 Agent 运行状态和统计数据。

---

### 用户故事2 - 使用 GitHub Copilot 模型进行对话（优先级：P2）
作为一个开发者，我希望利用我的 GitHub Copilot 订阅来驱动 solopreneur，以获得高质量的 AI 响应。
**优先级说明**：模型支持是 Agent 的大脑，Copilot 是目前广泛使用的优质资源。
**独立测试**：在配置文件中设置 Copilot 凭据，发送测试消息并接收响应。
**验收场景**：
1. **假设**已配置 Copilot API 密钥，**当**用户发送消息时，**则**系统应调用 GitHub Copilot 模型并返回正确的回复。

---

### 用户故事3 - 企业微信渠道交互（优先级：P1）
作为一个企业用户，我希望直接在企业微信中接收通知并与 Agent 沟通，以适应工作办公场景需求。
**优先级说明**：渠道支持决定了 Agent 的触达能力，企业微信是国内办公场景的核心。
**独立测试**：通过企业微信机器人或应用发送消息，观察总线是否接收到事件。
**验收场景**：
1. **假设**已配置企业微信回调地址，**当**用户在企业微信发送消息时，**则**Agent 应接收到消息并通过总线处理。

---

### 边界场景
- **模型认证失败**：Copilot 密钥失效时，系统应友好提示并记录日志。
- **网络连接异常**：当企业微信 API 通信失败时，Agent 应尝试重试或通知管理员。

## 需求（必填）

### 功能需求
- **FR-001**：在项目根目录创建一个新的前端文件夹 `ui`，使用 Vue 3 + TypeScript 进行开发。
- **FR-002**：前端界面必须包含四个核心模块：配置管理、聊天机器人交互、仪表盘统计、工作流展示。
- **FR-003**：实现一个新的 LLM Provider 以支持 GitHub Copilot 模型。
- **FR-004**：实现新的企业微信（WeCom）渠道支持。
- **FR-005**：完全物理删除现有的 Telegram (`solopreneur/channels/telegram.py`) 和 WhatsApp (`solopreneur/channels/whatsapp.py` 及 `bridge/` 目录) 渠道代码，仅保留基础基类逻辑。

### 关键实体（如涉及数据）
- **FrontendConfig**：存储前端构建和后端 API 连接的配置。
- **CopilotCredentials**：存储 GitHub Copilot 的认证令牌。
- **WeComMessage**：企业微信渠道的入站消息格式。

## 成功标准（必填）

### 可衡量结果
- **SC-001**：前端界面首屏加载时间在本地环境下小于 1.5 秒。
- **SC-002**：Copilot 模型响应延迟（排除网络因素）应与原生请求保持一致。
- **SC-003**：企业微信消息处理吞吐量支持每秒至少 5 条消息齐发且无丢失。

## 假设
- 假设用户已拥有合法的 GitHub Copilot 订阅或 API 访问权限。
- 假设企业微信渠道使用标准的应用 API 或机器人回调模式。

## 澄清

### 会话 2026-02-05
- Q：GitHub Copilot 认证方式 → A：OAuth 设备流 + 本地缓存 (`solopreneur login --provider github-copilot`)
- Q：企业微信集成类型 → A：企业微信群机器人（webhook 模式，无需企业认证）
- Q：前端-后端通信协议 → A：混合方案（REST API 管理配置 + WebSocket 推送实时状态）
- Q：代码删除范围 → A：完全删除 Telegram/WhatsApp 代码及相关依赖（包括 `bridge/` 目录）
- Q：前端部署模式 → A：Tauri 桌面应用（Vue3+TS 前端 + Rust 打包层，Python 后端作为 sidecar 进程）
- Q：Skills 与 Agent UI 设计 → A：属性表单流（Skill 列表表单配置 + Agent 核心 Markdown 文本编辑）
- Q：技能来源与编辑逻辑 → A：分层管理视图（清晰显示 Workspace/Managed/Bundled 来源，支持跨层重写）
- Q：Agent 定义同步策略 → A：自动保存 + 热加载（Hot-reload，文件变更即时生效）
- Q：工具调用安全策略 → A：实时审批流（Sensitive tool 调用在聊天界面弹出审批卡片）
- Q：流控与压缩可视化 → A：侧边栏任务追踪面板（展示 Followup 任务栈与历史压缩快照）
